{% comment %}
  Shelzy's Designs - Comprehensive SEO Meta Tags
  Includes: Open Graph, Twitter Cards, JSON-LD Schema Markup
  Add to theme.liquid in <head> section: {% render 'seo-meta-tags' %}
{% endcomment %}

{% comment %} Dynamic Meta Description {% endcomment %}
{% if template contains 'product' %}
  {% assign meta_description = product.description | strip_html | truncate: 155 %}
  {% if meta_description == blank %}
    {% assign meta_description = 'Shop ' | append: product.title | append: ' - Premium personalized water bottles with permanent sublimation printing. Starting at $24.99. Your name will never peel or fade!' %}
  {% endif %}
{% elsif template contains 'collection' %}
  {% assign meta_description = collection.description | strip_html | truncate: 155 %}
  {% if meta_description == blank %}
    {% assign meta_description = 'Shop ' | append: collection.title | append: ' - Premium personalized products with permanent sublimation printing. Free shipping on orders over $50.' %}
  {% endif %}
{% elsif template contains 'article' %}
  {% assign meta_description = article.excerpt | strip_html | truncate: 155 %}
  {% if meta_description == blank %}
    {% assign meta_description = article.content | strip_html | truncate: 155 %}
  {% endif %}
{% elsif template contains 'page' %}
  {% assign meta_description = page.content | strip_html | truncate: 155 %}
{% else %}
  {% assign meta_description = shop.description | strip_html | truncate: 155 %}
  {% if meta_description == blank %}
    {% assign meta_description = 'Shelzy\'s Designs - Premium personalized water bottles with permanent sublimation printing. No peeling, no fading - ever. Shop couples bottles, gifts & more!' %}
  {% endif %}
{% endif %}

{% comment %} Dynamic Page Title {% endcomment %}
{% if template contains 'index' %}
  {% assign page_title = 'Personalized Water Bottles with Permanent Sublimation Print | Shelzy\'s Designs' %}
{% elsif template contains 'product' %}
  {% assign page_title = product.title | append: ' | ' | append: shop.name %}
{% elsif template contains 'collection' %}
  {% assign page_title = collection.title | append: ' | ' | append: shop.name %}
{% elsif template contains 'article' %}
  {% assign page_title = article.title | append: ' | ' | append: shop.name %}
{% else %}
  {% assign page_title = page_title | append: ' | ' | append: shop.name %}
{% endif %}

{% comment %} Canonical URL {% endcomment %}
<link rel="canonical" href="{{ canonical_url }}">

{% comment %} Open Graph Tags {% endcomment %}
<meta property="og:site_name" content="{{ shop.name }}">
<meta property="og:url" content="{{ canonical_url }}">
<meta property="og:title" content="{{ page_title | escape }}">
<meta property="og:description" content="{{ meta_description | escape }}">

{% if template contains 'product' %}
  <meta property="og:type" content="product">
  <meta property="product:price:amount" content="{{ product.price | money_without_currency }}">
  <meta property="product:price:currency" content="{{ cart.currency.iso_code }}">
  {% if product.featured_image %}
    <meta property="og:image" content="https:{{ product.featured_image | image_url: width: 1200 }}">
    <meta property="og:image:secure_url" content="https:{{ product.featured_image | image_url: width: 1200 }}">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="{{ product.featured_image.alt | default: product.title | escape }}">
  {% endif %}
{% elsif template contains 'article' %}
  <meta property="og:type" content="article">
  <meta property="article:published_time" content="{{ article.published_at | date: '%Y-%m-%dT%H:%M:%S' }}">
  <meta property="article:author" content="{{ article.author }}">
  {% if article.image %}
    <meta property="og:image" content="https:{{ article.image | image_url: width: 1200 }}">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
  {% endif %}
{% elsif template contains 'collection' %}
  <meta property="og:type" content="website">
  {% if collection.image %}
    <meta property="og:image" content="https:{{ collection.image | image_url: width: 1200 }}">
  {% elsif collection.products.first.featured_image %}
    <meta property="og:image" content="https:{{ collection.products.first.featured_image | image_url: width: 1200 }}">
  {% endif %}
{% else %}
  <meta property="og:type" content="website">
  {% if settings.share_image %}
    <meta property="og:image" content="https:{{ settings.share_image | image_url: width: 1200 }}">
  {% endif %}
{% endif %}

{% comment %} Twitter Card Tags {% endcomment %}
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="{{ page_title | escape }}">
<meta name="twitter:description" content="{{ meta_description | escape }}">

{% if template contains 'product' and product.featured_image %}
  <meta name="twitter:image" content="https:{{ product.featured_image | image_url: width: 1200 }}">
{% elsif template contains 'article' and article.image %}
  <meta name="twitter:image" content="https:{{ article.image | image_url: width: 1200 }}">
{% elsif settings.share_image %}
  <meta name="twitter:image" content="https:{{ settings.share_image | image_url: width: 1200 }}">
{% endif %}

{% comment %} JSON-LD Schema Markup {% endcomment %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "{{ shop.name }}",
  "url": "{{ shop.url }}",
  "logo": "{% if settings.logo %}https:{{ settings.logo | image_url: width: 512 }}{% endif %}",
  "description": "{{ shop.description | strip_html | escape }}",
  "sameAs": [
    "{{ settings.social_facebook_link }}",
    "{{ settings.social_instagram_link }}",
    "{{ settings.social_tiktok_link }}",
    "{{ settings.social_pinterest_link }}"
  ],
  "contactPoint": {
    "@type": "ContactPoint",
    "contactType": "customer service",
    "email": "{{ shop.email }}"
  }
}
</script>

{% if template contains 'product' %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Product",
  "name": "{{ product.title | escape }}",
  "description": "{{ product.description | strip_html | escape }}",
  "image": [
    {% for image in product.images limit: 5 %}
      "https:{{ image | image_url: width: 1200 }}"{% unless forloop.last %},{% endunless %}
    {% endfor %}
  ],
  "sku": "{{ product.selected_or_first_available_variant.sku }}",
  "mpn": "{{ product.selected_or_first_available_variant.barcode }}",
  "brand": {
    "@type": "Brand",
    "name": "{{ product.vendor | default: shop.name }}"
  },
  "offers": {
    "@type": "Offer",
    "url": "{{ canonical_url }}",
    "priceCurrency": "{{ cart.currency.iso_code }}",
    "price": "{{ product.price | money_without_currency }}",
    "priceValidUntil": "{{ 'now' | date: '%Y' | plus: 1 }}-12-31",
    "availability": "{% if product.available %}https://schema.org/InStock{% else %}https://schema.org/OutOfStock{% endif %}",
    "seller": {
      "@type": "Organization",
      "name": "{{ shop.name }}"
    }
  }
  {% if product.metafields.reviews.rating %}
  ,"aggregateRating": {
    "@type": "AggregateRating",
    "ratingValue": "{{ product.metafields.reviews.rating.value.rating }}",
    "reviewCount": "{{ product.metafields.reviews.rating_count }}"
  }
  {% endif %}
}
</script>
{% endif %}

{% if template contains 'article' %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": "{{ article.title | escape }}",
  "description": "{{ article.excerpt | strip_html | escape }}",
  "image": "{% if article.image %}https:{{ article.image | image_url: width: 1200 }}{% endif %}",
  "datePublished": "{{ article.published_at | date: '%Y-%m-%dT%H:%M:%S' }}",
  "dateModified": "{{ article.updated_at | date: '%Y-%m-%dT%H:%M:%S' }}",
  "author": {
    "@type": "Person",
    "name": "{{ article.author }}"
  },
  "publisher": {
    "@type": "Organization",
    "name": "{{ shop.name }}",
    "logo": {
      "@type": "ImageObject",
      "url": "{% if settings.logo %}https:{{ settings.logo | image_url: width: 512 }}{% endif %}"
    }
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "{{ canonical_url }}"
  }
}
</script>
{% endif %}

{% if template contains 'collection' %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "CollectionPage",
  "name": "{{ collection.title | escape }}",
  "description": "{{ collection.description | strip_html | escape }}",
  "url": "{{ canonical_url }}",
  "mainEntity": {
    "@type": "ItemList",
    "itemListElement": [
      {% for product in collection.products limit: 10 %}
      {
        "@type": "ListItem",
        "position": {{ forloop.index }},
        "item": {
          "@type": "Product",
          "name": "{{ product.title | escape }}",
          "url": "{{ shop.url }}{{ product.url }}",
          "image": "{% if product.featured_image %}https:{{ product.featured_image | image_url: width: 600 }}{% endif %}",
          "offers": {
            "@type": "Offer",
            "price": "{{ product.price | money_without_currency }}",
            "priceCurrency": "{{ cart.currency.iso_code }}",
            "availability": "{% if product.available %}https://schema.org/InStock{% else %}https://schema.org/OutOfStock{% endif %}"
          }
        }
      }{% unless forloop.last %},{% endunless %}
      {% endfor %}
    ]
  }
}
</script>
{% endif %}

{% if template == 'index' %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "{{ shop.name }}",
  "url": "{{ shop.url }}",
  "potentialAction": {
    "@type": "SearchAction",
    "target": "{{ shop.url }}/search?q={search_term_string}",
    "query-input": "required name=search_term_string"
  }
}
</script>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Store",
  "name": "{{ shop.name }}",
  "description": "{{ meta_description | escape }}",
  "url": "{{ shop.url }}",
  "logo": "{% if settings.logo %}https:{{ settings.logo | image_url: width: 512 }}{% endif %}",
  "priceRange": "$$",
  "currenciesAccepted": "{{ cart.currency.iso_code }}",
  "paymentAccepted": "Credit Card, PayPal, Apple Pay, Google Pay, Shop Pay",
  "hasOfferCatalog": {
    "@type": "OfferCatalog",
    "name": "Personalized Water Bottles",
    "itemListElement": [
      {
        "@type": "OfferCatalog",
        "name": "Stainless Steel Bottles",
        "url": "{{ shop.url }}/collections/stainless-steel"
      },
      {
        "@type": "OfferCatalog",
        "name": "Couples Bottles",
        "url": "{{ shop.url }}/collections/couples"
      },
      {
        "@type": "OfferCatalog",
        "name": "Gift Sets",
        "url": "{{ shop.url }}/collections/gifts"
      }
    ]
  }
}
</script>
{% endif %}

{% comment %} Breadcrumb Schema {% endcomment %}
{% unless template == 'index' %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "{{ shop.url }}"
    }
    {% if template contains 'collection' %}
    ,{
      "@type": "ListItem",
      "position": 2,
      "name": "{{ collection.title | escape }}",
      "item": "{{ shop.url }}{{ collection.url }}"
    }
    {% endif %}
    {% if template contains 'product' %}
    {% if collection %}
    ,{
      "@type": "ListItem",
      "position": 2,
      "name": "{{ collection.title | escape }}",
      "item": "{{ shop.url }}{{ collection.url }}"
    }
    ,{
      "@type": "ListItem",
      "position": 3,
      "name": "{{ product.title | escape }}",
      "item": "{{ shop.url }}{{ product.url }}"
    }
    {% else %}
    ,{
      "@type": "ListItem",
      "position": 2,
      "name": "{{ product.title | escape }}",
      "item": "{{ shop.url }}{{ product.url }}"
    }
    {% endif %}
    {% endif %}
    {% if template contains 'article' %}
    ,{
      "@type": "ListItem",
      "position": 2,
      "name": "Blog",
      "item": "{{ shop.url }}/blogs/{{ blog.handle }}"
    }
    ,{
      "@type": "ListItem",
      "position": 3,
      "name": "{{ article.title | escape }}",
      "item": "{{ canonical_url }}"
    }
    {% endif %}
    {% if template contains 'page' %}
    ,{
      "@type": "ListItem",
      "position": 2,
      "name": "{{ page.title | escape }}",
      "item": "{{ canonical_url }}"
    }
    {% endif %}
  ]
}
</script>
{% endunless %}

{% comment %} FAQ Schema - Add to product/page templates as needed {% endcomment %}
{% if template contains 'product' and product.metafields.custom.faq_json %}
<script type="application/ld+json">
{{ product.metafields.custom.faq_json }}
</script>
{% endif %}

{% comment %} Additional Meta Tags {% endcomment %}
<meta name="theme-color" content="#EC4899">
<meta name="msapplication-TileColor" content="#EC4899">
<link rel="dns-prefetch" href="https://cdn.shopify.com">
<link rel="preconnect" href="https://cdn.shopify.com" crossorigin>
